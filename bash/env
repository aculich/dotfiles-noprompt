# -*- mode: sh; -*-
# vim:filetype=sh
source $MATILDE_ROOT/bash/util
require "file"
require "path"

ulimit -n 10240

# Command history file location.
export HISTFILE="$HOME/.bash_history"

# Format command history timestamps.
# See: strftime(3)
export HISTTIMEFORMAT="%F %T "

# Store no more than 4000 lines in the command history file.
export HISTSIZE=4000

# Remember no more than 2000 commands in the command history file.
export HISTFILESIZE=2000

# Enable colors with the `ls` command
#export CLICOLOR=1
#export LSCOLORS=Gxfxcxdxbxegedabagacad

# Use Vim as the default editor for everything.
export VISUAL=vim
export EDITOR=vim
export FCEDIT=vim

# Node
#[ `which npm` ] && export NODE_PATH=`npm -g root`

# Personal binaries
if file.directory? "$HOME/bin"; then
    path.push "$HOME/bin"
fi

# Homebrew
#if [ `which brew` ]; then
  #path.push "/usr/local/bin:$(brew --prefix coreutils)/libexec/gnubin"
#fi

# rbenv
if file.directory? "$HOME/.rbenv/bin"; then
    path.push "$HOME/.rbenv/bin"
    eval "$($HOME/.rbenv/bin/rbenv init -)"
else
    if file.exists? "/usr/local/var/rbenv"; then
        export RBENV_ROOT=/usr/local/var/rbenv
        eval "$(rbenv init -)";
    fi
fi

# Haskell
if file.directory? "$HOME/.cabal"; then
    path.push "$HOME/.cabal/bin"
fi

# VimClojure
if file.directory? "$HOME/lib/VimClojure"; then
  export VIMCLOJURE_SERVER_JAR="$(find "$HOME/lib/VimClojure" -name '*.jar' | tail -1)"
fi

# VirtualEnv
if file.exists? "/usr/local/bin/virtualenvwrapper.sh"; then
    export WORKON_HOME="$HOME/Envs"

    if file.directory? "$WORKON_HOME"; then
        source /usr/local/bin/virtualenvwrapper.sh
    else
        mkdir -p $WORKON_HOME
        source /usr/local/bin/virtualenvwrapper.sh
    fi
    
fi

# less
[ `which hilite` ] || brew install hilite
export LESSOPEN="|/usr/local/bin/src-hilite-lesspipe.sh %s"
export LESSOPEN="|/usr/local/bin/src-hilite-lesspipe.sh %s"
export LESS="-R -s -F -X"
export PAGER="less -s -F -X"
